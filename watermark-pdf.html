<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>PDF Watermark Tool - Add Watermark to PDF Online Free | easyjpgtopdf</title>
    <meta name="description" content="Add watermarks to PDF documents online for free. Protect your files with text or image watermarks. Free PDF watermark tool.">
    <meta name="keywords" content="watermark pdf, add watermark to pdf, pdf watermark tool, protect pdf with watermark, pdf watermarker">
<link href="css/footer.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"></link>
<script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    :root { --primary: #4361ee; --primary-dark: #3a0ca3; --secondary: #f72585; --success: #4cc9f0; --light: #f8f9fa; --dark: #212529; --gray: #6c757d; --border-radius: 12px; --box-shadow: 0 5px 15px rgba(0,0,0,0.08); --transition: all 0.3s ease; }
    body { background: linear-gradient(135deg, #f5f7ff 0%, #e9ecef 100%); color: var(--dark); min-height: 100vh; line-height: 1.6; display: flex; flex-direction: column; }
    .container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    /* Header (same as word-to-pdf.html) */
    header { background: #fff; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,.08); }
    .navbar { display: flex; justify-content: space-between; align-items: center; padding: 14px 0; }
    .logo { display: flex; gap: 10px; align-items: center; font-size: 22px; font-weight: 700; color: var(--primary); text-decoration: none; }
    .logo i { color: var(--primary-dark); }
    .nav-links { display: flex; gap: 22px; }
    .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; }
    .nav-links a.active, .nav-links a:hover { color: var(--primary); }
    .dropdown { position: relative; }
    .dropdown-content { display: none; position: absolute; background: #fff; min-width: 200px; box-shadow: 0 8px 16px rgba(0,0,0,.1); border-radius: 8px; padding: 10px 0; top: 100%; left: 0; }
    .dropdown:hover .dropdown-content { display: block; }
    .dropdown-content a { display: block; padding: 10px 20px; text-decoration: none; color: var(--dark); }
    .dropdown-content a:hover { background: var(--light); }
    .auth-buttons { display:flex; gap:10px; }
    .auth-btn { padding:6px 15px; border-radius:50px; text-decoration:none; font-weight:500; transition:.3s; font-size:.9rem; }
    .auth-btn.login { background: transparent; color: var(--primary); border:1px solid var(--primary); }
    .auth-btn.signup { background: var(--primary); color:#fff; border:1px solid var(--primary); }
    /* Page specific */
    .page-wrap { padding: 20px 0; }
    .converter-header { text-align: center; margin-bottom: 30px; padding: 20px; }
    .converter-header h1 { font-size: 2.2rem; color: var(--primary); margin-bottom: 10px; }
    .converter-header p { font-size: 1.05rem; color: var(--gray); max-width: 700px; margin: 0 auto; }
    .converter-card { background: #fff; border-radius: var(--border-radius); padding: 30px; box-shadow: var(--box-shadow); margin-bottom: 30px; }
    .upload-area { border: 3px dashed #ddd; border-radius: var(--border-radius); padding: 40px 20px; text-align: center; cursor: pointer; margin-bottom: 20px; transition: var(--transition); position: relative; }
    .upload-area:hover { border-color: var(--primary); background: rgba(67, 97, 238, 0.03); }
    .upload-area.dragover { border-color: var(--primary); background: rgba(67, 97, 238, 0.08); }
    .upload-icon { font-size: 64px; color: var(--primary); margin-bottom: 15px; }
    .upload-area h3 { font-size: 1.5rem; margin-bottom: 10px; color: var(--dark); }
    .upload-area p { color: var(--gray); margin-bottom: 5px; }
    .file-input { display: none; }
    .file-info { background: var(--light); border-radius: var(--border-radius); padding: 20px; margin: 20px 0; display: none; }
    .file-details { display: flex; align-items: center; gap: 15px; }
    .file-icon { font-size: 40px; color: var(--primary); }
    .file-text h4 { font-size: 1.2rem; margin-bottom: 5px; }
    .file-text p { color: var(--gray); font-size: 0.9rem; }
    .options-section { margin: 25px 0; padding: 20px; background: var(--light); border-radius: var(--border-radius); }
    .options-section h3 { margin-bottom: 15px; color: var(--primary); }
    .option-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; }
    .option-group { display: flex; flex-direction: column; gap: 8px; }
    .option-group label { font-weight: 500; }
    .option-select, .option-input { width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; background: white; font-size: 1rem; }
    .range { width: 100%; }
    .inline { display: flex; gap: 10px; align-items: center; }
    .action-buttons { display: flex; gap: 15px; margin-top: 25px; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 24px; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: var(--transition); text-decoration: none; }
    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    .btn-secondary { background: white; color: var(--primary); border: 2px solid var(--primary); }
    .btn-secondary:hover { background: var(--light); }
    .btn:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }
    .progress-container { margin: 20px 0; display: none; }
    .progress-bar { width: 100%; height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden; }
    .progress { height: 100%; background: linear-gradient(90deg, var(--primary), var(--success)); width: 0%; transition: width 0.4s ease; }
    .progress-text { text-align: center; margin-top: 10px; color: var(--gray); font-size: 0.9rem; }
    .loading { display: none; text-align: center; padding: 30px; }
    .loading-spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .message { padding: 15px; border-radius: 8px; margin: 20px 0; display: none; }
    .success-message { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .error-message { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .preview-section { margin-top: 30px; display:none; }
    .preview-container { border: 1px solid #ddd; border-radius: var(--border-radius); padding: 20px; background: white; max-height: 400px; overflow-y: auto; }
    /* Footer */
    footer { background: #212529; color: #fff; margin-top: auto; padding: 60px 0 30px; }
    .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; margin-bottom: 40px; }
    .footer-links { list-style: none; }
    .footer-links a { color: #aaa; text-decoration: none; }
    .footer-links a:hover { color: #fff; }
    .copyright { text-align: center; color: #aaa; border-top: 1px solid #444; padding-top: 16px; font-size: .9rem; }
    @media (max-width: 768px) { .nav-links { display: none; } .action-buttons { flex-direction: column; } .btn { width: 100%; justify-content: center; } }
  </style>
<link href="css/header.css" rel="stylesheet"/>
<link href="css/theme-modern.css" rel="stylesheet"/>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "PDF Watermark Tool - Add Watermark to PDF Online Free | easyjpgtopdf",
      "description": "Add watermarks to PDF documents online for free. Protect your files with text or image watermarks. Free PDF watermark tool.",
      "url": "https://easyjpgtopdf.com/watermark-pdf.html",
      "inLanguage": "en-US",
      "isPartOf": {
        "@type": "WebSite",
        "name": "easyjpgtopdf",
        "url": "https://easyjpgtopdf.com"
      },
      "publisher": {
        "@type": "Organization",
        "name": "easyjpgtopdf",
        "url": "https://easyjpgtopdf.com"
      }
    }
    </script>
</head>
<body>
<header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo"><img src="images/logo.png" alt="Logo" style="height:54px;"></a>
                <div class="nav-links">
                    <div class="dropdown">
                        <a href="#">Convert to PDF <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="jpg-to-pdf.html">JPG to PDF</a>
                            <a href="word-to-pdf.html">Word to PDF</a>
                            <a href="excel-to-pdf.html">Excel to PDF</a>
                            <a href="ppt-to-pdf.html">PowerPoint to PDF</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <a href="#">Convert from PDF <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="pdf-to-jpg.html">PDF to JPG</a>
                            <a href="pdf-to-word.html">PDF to Word</a>
                            <a href="pdf-to-excel.html">PDF to Excel</a>
                            <a href="pdf-to-ppt.html">PDF to PowerPoint</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <a href="#">Pdf Editor <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="merge-pdf.html">Merge PDF</a>
                            <a href="split-pdf.html">Split PDF</a>
                            <a href="compress-pdf.html">Compress PDF</a>
                            <a href="edit-pdf.html">Pdf Editor</a>
                            <a href="protect-pdf.html">Protect PDF</a>
                            <a href="unlock-pdf.html">Unlock PDF</a>
                            <a href="watermark-pdf.html">Watermark PDF</a>
                            <a href="crop-pdf.html">Crop PDF</a>
                            <a href="add-page-numbers.html">Add Page Numbers</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <a href="#">Image Tools <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="image-repair.html">AI Image Repair</a>
                            <a href="image-compressor.html">Image Compressor</a>
                            <a href="image-resizer.html">Image Resizer</a>
                            <a href="image-editor.html">Image Editor</a>
                            <a href="background-remover.html">Image Background Remover</a>
                            <a href="ocr-image.html">OCR Image</a>
                            <a href="image-watermark.html">Image Watermark Tool</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <a href="#">Other Tools <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="resume-maker.html">Resume Maker</a>
                            <a href="biodata-maker.html">Marrige Biodata-Data Maker</a>
                            <a href="ai-image-generator.html">AI Image Generator</a>
                            <a href="marriage-card.html">Marriage Card</a>
                            <a href="excel-unlocker/" target="_blank">Excel Unlocker</a>
                            <a href="protect-excel.html">Protect Excel Sheet</a>
                        </div>
                    </div>
                    <div class="dropdown">
                        <a href="#">More <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="pricing.html">Pricing</a>
                            <a href="blog.html">Blog/Articles</a>
                            
                            
                        </div>
                    </div>
                </div>
                
                <div id="user-menu" class="user-menu" data-open="false">
                    <button id="user-menu-toggle" class="user-menu-toggle" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Account menu">
                        <span class="user-initial" aria-hidden="true">U</span>
                        <i class="fas fa-chevron-down" aria-hidden="true"></i>
                    </button>
                    <div class="user-dropdown" id="user-dropdown" hidden>
                        <a href="dashboard.html#dashboard-overview" data-user-nav="dashboard-overview"><i class="fas fa-user-circle"></i> Account Dashboard</a>
                        <a href="dashboard.html#dashboard-billing" data-user-nav="dashboard-billing"><i class="fas fa-file-invoice"></i> Billing Details</a>
                        <a href="dashboard.html#dashboard-payments" data-user-nav="dashboard-payments"><i class="fas fa-wallet"></i> Payment History</a>
                        <a href="dashboard.html#dashboard-orders" data-user-nav="dashboard-orders"><i class="fas fa-clipboard-list"></i> Orders &amp; Subscriptions</a>
                        <a href="accounts.html#login"><i class="fas fa-user-cog"></i> Account Center</a>
                        <button type="button" id="logout-button" class="dropdown-logout"><i class="fas fa-sign-out-alt"></i> Sign out</button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

        <nav aria-label="Breadcrumb" style="padding: 15px 0; background: #f8f9ff; border-bottom: 1px solid #e2e6ff;">
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 24px;">
            <ol style="list-style: none; display: flex; flex-wrap: wrap; gap: 10px; margin: 0; padding: 0; align-items: center;">
                <li><a href="index.html" style="color: #4361ee; text-decoration: none; font-weight: 500; transition: color 0.3s;" onmouseover="this.style.color='#3a0ca3'" onmouseout="this.style.color='#4361ee'">Home</a></li>
                <li><span style="margin: 0 8px; color: #9ca3af;">|</span></li>
                <li><a href="login.html" style="color: #56607a; font-weight: 500; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#4361ee'" onmouseout="this.style.color='#56607a'">Sign In</a></li>
                <li><span style="margin: 0 8px; color: #9ca3af;">|</span></li>
                <li><a href="signup.html" style="color: #56607a; font-weight: 500; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#4361ee'" onmouseout="this.style.color='#56607a'">Signup</a></li>
            </ol>
        </div>
    </nav>

<!-- Header from index.html -->
<div class="container page-wrap">
<div class="converter-header">
<h1>PDF Watermark Tool - Add Watermark to PDF Online Free</h1>
<p>Add custom watermark text to your PDF. Fast, secure, and works in your browser.</p>
</div>
<div class="converter-card">
<div class="upload-area" id="upload-area">
<div class="upload-icon"><i class="fas fa-file-pdf"></i></div>
<h3>Upload Your PDF</h3>
<p>Drag &amp; drop your .pdf file here</p>
<p>or click to browse files</p>
<input accept="application/pdf,.pdf" class="file-input" id="file-input" type="file"/>
</div>
<div class="file-info" id="file-info">
<div class="file-details">
<div class="file-icon"><i class="fas fa-file-pdf"></i></div>
<div class="file-text">
<h4 id="file-name">Document.pdf</h4>
<p id="file-size">0 KB</p>
</div>
</div>
</div>
<div class="options-section">
<h3>Watermark Options</h3>
<div class="option-grid">
<div class="option-group">
<label for="wm-text">Watermark Text</label>
<input class="option-input" id="wm-text" placeholder="CONFIDENTIAL" type="text" value="CONFIDENTIAL"/>
</div>
<div class="option-group">
<label for="wm-size">Font Size (pt)</label>
<input class="option-input" id="wm-size" max="200" min="8" step="1" type="number" value="48"/>
</div>
<div class="option-group">
<label for="wm-color">Color</label>
<input class="option-input" id="wm-color" type="color" value="#ff0000"/>
</div>
<div class="option-group">
<label for="wm-opacity">Opacity: <span id="wm-opacity-val">0.2</span></label>
<input class="range" id="wm-opacity" max="1" min="0.05" step="0.05" type="range" value="0.2"/>
</div>
<div class="option-group">
<label for="wm-rotation">Rotation (deg)</label>
<input class="option-input" id="wm-rotation" max="180" min="-180" step="1" type="number" value="45"/>
</div>
<div class="option-group">
<label for="wm-position">Position</label>
<select class="option-select" id="wm-position">
<option selected="" value="center-diagonal">Center (Diagonal)</option>
<option value="center">Center</option>
<option value="top-left">Top Left</option>
<option value="top-right">Top Right</option>
<option value="bottom-left">Bottom Left</option>
<option value="bottom-right">Bottom Right</option>
</select>
</div>
<div class="option-group">
<label>Apply To</label>
<div class="inline"><input checked="" id="all-pages" type="checkbox"/><label for="all-pages">All Pages</label></div>
<small style="color:var(--gray)">If off, watermark only first page</small>
</div>
<!-- Logo watermark options -->
<div class="option-group">
<label class="inline" for="enable-logo"><input id="enable-logo" style="margin-right:8px;" type="checkbox"/> Add Logo Watermark</label>
<input accept="image/png,image/jpeg" class="option-input" id="wm-logo-file" type="file"></input>
</div>
<div class="option-group">
<label for="wm-logo-scale">Logo Size (% of page width)</label>
<input class="option-input" id="wm-logo-scale" max="100" min="5" step="1" type="number" value="30"/>
</div>
<div class="option-group">
<label for="wm-logo-rotation">Logo Rotation (deg)</label>
<input class="option-input" id="wm-logo-rotation" max="180" min="-180" step="1" type="number" value="0"/>
</div>
<div class="option-group">
<label for="wm-logo-opacity">Logo Opacity: <span id="wm-logo-opacity-val">0.3</span></label>
<input class="range" id="wm-logo-opacity" max="1" min="0.05" step="0.05" type="range" value="0.3"/>
</div>
</div>
</div>
<div class="progress-container" id="progress-container">
<div class="progress-bar"><div class="progress" id="progress-bar"></div></div>
<div class="progress-text" id="progress-text">Initializing...</div>
</div>
<div class="loading" id="loading">
<div class="loading-spinner"></div>
<p>Applying watermark to your PDF...</p>
</div>
<div class="success-message message" id="success-message"><i class="fas fa-check-circle"></i> Watermark added successfully!</div>
<div class="error-message message" id="error-message"><i class="fas fa-exclamation-circle"></i> <span id="error-text">An error occurred</span></div>
<div class="action-buttons">
<button class="btn btn-primary" disabled="" id="convert-btn"><i class="fas fa-water"></i> Add Watermark</button>
<button class="btn btn-secondary" id="clear-btn"><i class="fas fa-trash"></i> Clear File</button>
</div>
<div class="preview-section" id="preview-section"></div>
</div>
<!-- Comments (same style as word-to-pdf.html) -->
</div>
<!-- Footer (same as word-to-pdf.html) -->
<script>
    let currentFile = null; let originalPdfBytes = null;
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-input');
    const fileInfo = document.getElementById('file-info');
    const fileName = document.getElementById('file-name');
    const fileSize = document.getElementById('file-size');
    const convertBtn = document.getElementById('convert-btn');
    const clearBtn = document.getElementById('clear-btn');
    const progressContainer = document.getElementById('progress-container');
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');
    const loading = document.getElementById('loading');
    const successMessage = document.getElementById('success-message');
    const errorMessage = document.getElementById('error-message');
    const errorText = document.getElementById('error-text');

    const wmText = document.getElementById('wm-text');
    const wmSize = document.getElementById('wm-size');
    const wmColor = document.getElementById('wm-color');
    const wmOpacity = document.getElementById('wm-opacity');
    const wmOpacityVal = document.getElementById('wm-opacity-val');
    const wmRotation = document.getElementById('wm-rotation');
    const wmPosition = document.getElementById('wm-position');
    const allPages = document.getElementById('all-pages');

    // Logo controls
    const enableLogo = document.getElementById('enable-logo');
    const wmLogoFile = document.getElementById('wm-logo-file');
    const wmLogoScale = document.getElementById('wm-logo-scale');
    const wmLogoRotation = document.getElementById('wm-logo-rotation');
    const wmLogoOpacity = document.getElementById('wm-logo-opacity');
    const wmLogoOpacityVal = document.getElementById('wm-logo-opacity-val');

    wmOpacity.addEventListener('input', () => wmOpacityVal.textContent = wmOpacity.value);
    wmLogoOpacity.addEventListener('input', () => wmLogoOpacityVal.textContent = wmLogoOpacity.value);

    uploadArea.addEventListener('click', () => fileInput.click());
    uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); });
    uploadArea.addEventListener('dragleave', () => { uploadArea.classList.remove('dragover'); });
    uploadArea.addEventListener('drop', (e) => { e.preventDefault(); uploadArea.classList.remove('dragover'); if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]); });
    fileInput.addEventListener('change', (e) => { if (e.target.files.length > 0) handleFile(e.target.files[0]); });
    convertBtn.addEventListener('click', addWatermark);
    clearBtn.addEventListener('click', clearFile);

    function handleFile(file){
      if (!file || !/\.pdf$/i.test(file.name)) { showError('Please select a valid PDF file (.pdf)'); return; }
      if (file.size > 50 * 1024 * 1024) { showError('File size exceeds 50MB limit. Please choose a smaller file.'); return; }
      currentFile = file; fileName.textContent = file.name; fileSize.textContent = formatFileSize(file.size);
      const reader = new FileReader(); reader.onload = () => { originalPdfBytes = new Uint8Array(reader.result); convertBtn.disabled = false; fileInfo.style.display = 'block'; hideMessages(); }; reader.onerror = () => showError('Failed to read PDF file'); reader.readAsArrayBuffer(file);
    }

    function hexToRgb01(hex){
      const h = hex.replace('#',''); const bigint = parseInt(h, 16);
      const r = (bigint >> 16) & 255; const g = (bigint >> 8) & 255; const b = bigint & 255;
      return { r: r/255, g: g/255, b: b/255 };
    }

    function centerPosition(page, textWidth, textHeight){
      const { width, height } = page.getSize();
      return { x: (width - textWidth)/2, y: (height - textHeight)/2 };
    }

    function readFileAsArrayBuffer(file){
      return new Promise((resolve, reject) => {
        const r = new FileReader();
        r.onload = () => resolve(new Uint8Array(r.result));
        r.onerror = reject;
        r.readAsArrayBuffer(file);
      });
    }

    async function addWatermark(){
      if (!currentFile || !originalPdfBytes) { showError('Please upload a PDF first'); return; }
      hideMessages(); loading.style.display='block'; progressContainer.style.display='block'; convertBtn.disabled=true;
      try{
        updateProgress(10, 'Loading PDF...');
        const { PDFDocument, StandardFonts, rgb, degrees } = PDFLib;
        const pdfDoc = await PDFDocument.load(originalPdfBytes, { ignoreEncryption: true });
        const font = await pdfDoc.embedFont(StandardFonts.HelveticaBold);
        const color = hexToRgb01(wmColor.value);
        const opacity = Math.max(0.05, Math.min(1, parseFloat(wmOpacity.value) || 0.2));
        const text = wmText.value || 'CONFIDENTIAL';
        const size = Math.max(8, Math.min(200, parseFloat(wmSize.value) || 48));
        const angle = parseFloat(wmRotation.value) || 0;

        // Prepare optional logo
        let logoImage = null;
        let logoDims = null;
        const logoEnabled = enableLogo && enableLogo.checked && wmLogoFile && wmLogoFile.files && wmLogoFile.files[0];
        if (logoEnabled){
          try{
            const logoBytes = await readFileAsArrayBuffer(wmLogoFile.files[0]);
            const isPng = /\.png$/i.test(wmLogoFile.files[0].name);
            logoImage = isPng ? await pdfDoc.embedPng(logoBytes) : await pdfDoc.embedJpg(logoBytes);
            logoDims = logoImage.scale(1);
          }catch(e){ console.warn('Failed to embed logo image', e); }
        }

        const pages = pdfDoc.getPages();
        const applyAll = allPages.checked;
        const targetPages = applyAll ? pages : [pages[0]];

        for (let i=0;i<targetPages.length;i++){
          const page = targetPages[i];
          const { width, height } = page.getSize();
          const textWidth = font.widthOfTextAtSize(text, size);
          const textHeight = font.heightAtSize(size);

          let x = 0, y = 0, rotateDeg = angle;
          const pos = wmPosition.value;
          if (pos === 'center-diagonal'){ const c = centerPosition(page, textWidth, textHeight); x = c.x; y = c.y; if (!wmRotation.value) rotateDeg = 45; }
          else if (pos === 'center'){ const c = centerPosition(page, textWidth, textHeight); x = c.x; y = c.y; }
          else if (pos === 'top-left'){ x = 36; y = height - textHeight - 36; rotateDeg = angle; }
          else if (pos === 'top-right'){ x = width - textWidth - 36; y = height - textHeight - 36; }
          else if (pos === 'bottom-left'){ x = 36; y = 36; }
          else if (pos === 'bottom-right'){ x = width - textWidth - 36; y = 36; }

          page.drawText(text, {
            x, y,
            size,
            font,
            color: rgb(color.r, color.g, color.b),
            rotate: degrees(rotateDeg),
            opacity
          });

          // Draw logo if provided
          if (logoImage){
            const scalePct = Math.max(5, Math.min(100, parseFloat(wmLogoScale.value) || 30));
            const logoRotate = parseFloat(wmLogoRotation.value) || 0;
            const logoOpacity = Math.max(0.05, Math.min(1, parseFloat(wmLogoOpacity.value) || 0.3));
            const drawWidth = (width * scalePct) / 100;
            const aspect = logoDims.width / logoDims.height;
            const drawHeight = drawWidth / Math.max(0.01, aspect);
            let lx = 0, ly = 0;
            if (pos === 'center' || pos === 'center-diagonal'){
              const c = centerPosition(page, drawWidth, drawHeight); lx = c.x; ly = c.y;
            } else if (pos === 'top-left'){ lx = 36; ly = height - drawHeight - 36; }
            else if (pos === 'top-right'){ lx = width - drawWidth - 36; ly = height - drawHeight - 36; }
            else if (pos === 'bottom-left'){ lx = 36; ly = 36; }
            else if (pos === 'bottom-right'){ lx = width - drawWidth - 36; ly = 36; }

            page.drawImage(logoImage, {
              x: lx,
              y: ly,
              width: drawWidth,
              height: drawHeight,
              rotate: degrees(logoRotate),
              opacity: logoOpacity
            });
          }
        }

        updateProgress(90, 'Preparing preview...');
        const dataUrl = await pdfDoc.saveAsBase64({ dataUri: true });
        const outName = currentFile.name.replace(/\.[^/.]+$/, '') + '-watermarked.pdf';
        try {
          sessionStorage.setItem('wm_pdf_dataurl', dataUrl);
          sessionStorage.setItem('wm_filename', outName);
          sessionStorage.setItem('wm_pages', String(pdfDoc.getPages().length));
        } catch(e) { console.warn('sessionStorage write failed', e); try { window.name = JSON.stringify({ tag:'WM', wm_pdf_dataurl:dataUrl, wm_filename:outName, wm_pages:String(pdfDoc.getPages().length) }); } catch(err){} }
        updateProgress(100, 'Redirecting...');
        window.location.href = 'watermark-pdf-convert.html';
      }catch(err){ console.error(err); showError('Failed to add watermark. Please try another file.'); }
      finally{ loading.style.display='none'; progressContainer.style.display='none'; progressBar.style.width='0%'; convertBtn.disabled=false; }
    }

    function clearFile(){ currentFile=null; originalPdfBytes=null; fileInput.value=''; fileInfo.style.display='none'; convertBtn.disabled=true; hideMessages(); }
    function updateProgress(percent, text){ progressBar.style.width = `${percent}%`; progressText.textContent = text; }
    function formatFileSize(bytes){ if (bytes < 1024) return bytes + ' bytes'; else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB'; else return (bytes / 1048576).toFixed(1) + ' MB'; }
    function showError(message){ errorText.textContent = message; errorMessage.style.display='block'; }
    function hideMessages(){ successMessage.style.display='none'; errorMessage.style.display='none'; }
  </script>
    
<script src="js/auth.js" type="module">

    
    <section class="how-to-guide" style="margin: 40px 0; padding: 40px; background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        <h2 style="font-size: 2rem; color: #4361ee; margin-bottom: 30px; text-align: center;">
            <i class="fas fa-book-open" style="margin-right: 10px;"></i>
            How to Use Watermark Pdf
        </h2>
        <div class="steps-container" style="max-width: 800px; margin: 0 auto;">
            <ol style="list-style: none; padding: 0; counter-reset: step-counter;">

                <li style="counter-increment: step-counter; margin-bottom: 25px; padding: 20px; background: #f8f9ff; border-radius: 12px; border-left: 4px solid #4361ee; position: relative; padding-left: 60px;">
                    <span style="position: absolute; left: 15px; top: 20px; background: #4361ee; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.1rem;">
                        1
                    </span>
                    <p style="font-size: 1.1rem; color: #0b1630; line-height: 1.6; margin: 0;">
                        Upload your file
                    </p>
                </li>

                <li style="counter-increment: step-counter; margin-bottom: 25px; padding: 20px; background: #f8f9ff; border-radius: 12px; border-left: 4px solid #4361ee; position: relative; padding-left: 60px;">
                    <span style="position: absolute; left: 15px; top: 20px; background: #4361ee; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.1rem;">
                        2
                    </span>
                    <p style="font-size: 1.1rem; color: #0b1630; line-height: 1.6; margin: 0;">
                        Process using our tool
                    </p>
                </li>

                <li style="counter-increment: step-counter; margin-bottom: 25px; padding: 20px; background: #f8f9ff; border-radius: 12px; border-left: 4px solid #4361ee; position: relative; padding-left: 60px;">
                    <span style="position: absolute; left: 15px; top: 20px; background: #4361ee; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.1rem;">
                        3
                    </span>
                    <p style="font-size: 1.1rem; color: #0b1630; line-height: 1.6; margin: 0;">
                        Download the result
                    </p>
                </li>

            </ol>
        </div>
    </section>

    <section class="faq-section" style="margin: 40px 0; padding: 40px; background: #f8f9ff; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        <h2 style="font-size: 2rem; color: #4361ee; margin-bottom: 30px; text-align: center;">
            <i class="fas fa-question-circle" style="margin-right: 10px;"></i>
            Frequently Asked Questions
        </h2>
        <div class="faq-container" style="max-width: 800px; margin: 0 auto;">

            <div class="faq-item" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 12px; border-left: 4px solid #4361ee; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="font-size: 1.2rem; color: #0b1630; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center;" onclick="toggleFaq(this)">
                    <i class="fas fa-chevron-right" style="color: #4361ee; margin-right: 10px; transition: transform 0.3s;"></i>
                    How accurate is the conversion?
                </h3>
                <div class="faq-answer" style="font-size: 1rem; color: #56607a; line-height: 1.6; margin-top: 10px; display: none; padding-left: 30px;">
                    Our conversion tools maintain 99% accuracy, preserving all formatting, fonts, and layout from your original files.
                </div>
            </div>

            <div class="faq-item" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 12px; border-left: 4px solid #4361ee; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="font-size: 1.2rem; color: #0b1630; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center;" onclick="toggleFaq(this)">
                    <i class="fas fa-chevron-right" style="color: #4361ee; margin-right: 10px; transition: transform 0.3s;"></i>
                    What file sizes are supported?
                </h3>
                <div class="faq-answer" style="font-size: 1rem; color: #56607a; line-height: 1.6; margin-top: 10px; display: none; padding-left: 30px;">
                    Free users can convert files up to 10MB. Premium users can process files up to 100MB with faster processing.
                </div>
            </div>

            <div class="faq-item" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 12px; border-left: 4px solid #4361ee; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="font-size: 1.2rem; color: #0b1630; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center;" onclick="toggleFaq(this)">
                    <i class="fas fa-chevron-right" style="color: #4361ee; margin-right: 10px; transition: transform 0.3s;"></i>
                    Will my data be secure?
                </h3>
                <div class="faq-answer" style="font-size: 1rem; color: #56607a; line-height: 1.6; margin-top: 10px; display: none; padding-left: 30px;">
                    Yes, all files are processed securely and automatically deleted after conversion. We never store or share your documents.
                </div>
            </div>

            <div class="faq-item" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 12px; border-left: 4px solid #4361ee; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="font-size: 1.2rem; color: #0b1630; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center;" onclick="toggleFaq(this)">
                    <i class="fas fa-chevron-right" style="color: #4361ee; margin-right: 10px; transition: transform 0.3s;"></i>
                    Can I convert multiple files at once?
                </h3>
                <div class="faq-answer" style="font-size: 1rem; color: #56607a; line-height: 1.6; margin-top: 10px; display: none; padding-left: 30px;">
                    Yes, premium users can convert multiple files simultaneously. Free users can process one file at a time.
                </div>
            </div>

            <div class="faq-item" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 12px; border-left: 4px solid #4361ee; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="font-size: 1.2rem; color: #0b1630; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center;" onclick="toggleFaq(this)">
                    <i class="fas fa-chevron-right" style="color: #4361ee; margin-right: 10px; transition: transform 0.3s;"></i>
                    What formats are supported?
                </h3>
                <div class="faq-answer" style="font-size: 1rem; color: #56607a; line-height: 1.6; margin-top: 10px; display: none; padding-left: 30px;">
                    We support all major file formats. Check the tool page for specific format compatibility.
                </div>
            </div>

        </div>
    </section>
    
    <script>
    function toggleFaq(element) {
        const answer = element.nextElementSibling;
        const icon = element.querySelector('i');
        const isOpen = answer.style.display === 'block';
        
        answer.style.display = isOpen ? 'none' : 'block';
        icon.style.transform = isOpen ? 'rotate(0deg)' : 'rotate(90deg)';
    }
    </script>

    <div class="trust-badges" style="text-align: center; padding: 20px; background: linear-gradient(135deg, #f8f9ff, #ffffff); border-radius: 12px; margin: 30px 0; border: 2px solid #e2e6ff;">
        <div style="display: flex; justify-content: center; align-items: center; gap: 40px; flex-wrap: wrap;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-shield-alt" style="font-size: 2rem; color: #4361ee;"></i>
                <div style="text-align: left;">
                    <div style="color: #0b1630; font-weight: 600; font-size: 1.1rem;">SSL Secured</div>
                    <div style="color: #56607a; font-size: 0.9rem;">256-bit Encryption</div>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-lock" style="font-size: 2rem; color: #4361ee;"></i>
                <div style="text-align: left;">
                    <div style="color: #0b1630; font-weight: 600; font-size: 1.1rem;">100% Secure</div>
                    <div style="color: #56607a; font-size: 0.9rem;">Files Auto-Deleted</div>
                </div>
            </div>
            
        </div>
    </div>
<footer>
        <div class="container footer-inner">
            <div class="footer-company-links">
                <span>Company</span>
                <a href="index.html#about">About Us</a>
                <a href="index.html#contact">Contact</a>
                <a href="pricing.html">Pricing</a>
                <a href="privacy-policy.html">Privacy Policy</a>
                <a href="terms-of-service.html">Terms of Service</a>
                <a href="dmca-en.html">DMCA</a>
                <a href="blog.html">Blog</a>
            </div>
            <p class="footer-brand-line">&copy; easyjpgtopdf &mdash; Free PDF &amp; Image Tools for everyone. All rights reserved.</p>
            <p class="footer-credits">
                Thanks to Font Awesome, Google Fonts, jsPDF, pdf.js, pdf-lib, Mammoth, Tesseract.js, IMG.LY, Firebase, Unsplash photographers, and every open-source contributor powering this site.
                <a href="attributions.html">See full acknowledgements</a>.
            </p>
        </div>
    </footer>
</body>
</html>
